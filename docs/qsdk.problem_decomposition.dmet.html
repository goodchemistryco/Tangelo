
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>qsdk.problem_decomposition.dmet package &#8212; qSDK 0.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="qsdk-problem-decomposition-dmet-package">
<h1>qsdk.problem_decomposition.dmet package<a class="headerlink" href="#qsdk-problem-decomposition-dmet-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-qsdk.problem_decomposition.dmet.dmet_problem_decomposition">
<span id="qsdk-problem-decomposition-dmet-dmet-problem-decomposition-module"></span><h2>qsdk.problem_decomposition.dmet.dmet_problem_decomposition module<a class="headerlink" href="#module-qsdk.problem_decomposition.dmet.dmet_problem_decomposition" title="Permalink to this headline">¶</a></h2>
<p>Employ DMET as a problem decomposition technique.</p>
<dl class="py class">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">qsdk.problem_decomposition.dmet.dmet_problem_decomposition.</span></span><span class="sig-name descname"><span class="pre">DMETProblemDecomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="qsdk.problem_decomposition.html#qsdk.problem_decomposition.problem_decomposition.ProblemDecomposition" title="qsdk.problem_decomposition.problem_decomposition.ProblemDecomposition"><code class="xref py py-class docutils literal notranslate"><span class="pre">qsdk.problem_decomposition.problem_decomposition.ProblemDecomposition</span></code></a></p>
<p>DMET single-shot algorithm is used for problem decomposition technique.
By default, CCSD is used as the electronic structure solver, and Meta-Lowdin
is used for the localization scheme. Users can define other electronic
structure solver such as FCI or VQE as an impurity solver. IAO scheme can be
used instead of the Meta-Lowdin localization scheme, but it cannot be used
for minimal basis set.</p>
<dl>
<dt>Attributes:</dt><dd><p>molecule (SecondQuantizedMolecule): The molecular system.
electron_localization (Localization): A type of localization scheme.</p>
<blockquote>
<div><p>Default is Meta-Lowdin.</p>
</div></blockquote>
<dl class="simple">
<dt>fragment_atoms (list): List of number of atoms in each fragment. Sum of</dt><dd><p>this list should be the same as the number of atoms in the original
system.</p>
</dd>
<dt>fragment_solvers (list or str): List of solvers for each fragment. If</dt><dd><p>only a string is detected, this solver is used for all fragments.</p>
</dd>
<dt>optimizer (function handle): A function defining the classical optimizer</dt><dd><p>and its behavior.</p>
</dd>
<dt>initial_chemical_potential (str or array-like)<span class="classifier">Initial value for the</span></dt><dd><p>chemical potential.</p>
</dd>
<dt>solvers_options (list or dict): List of dictionaries for the solver</dt><dd><p>options. If only a single dictionary is passed, the same options are
applied for every solver. This will raise an error if different
solvers are parsed.</p>
</dd>
</dl>
<p>verbose (bool) : Flag for DMET verbosity.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.build" title="Permalink to this definition">¶</a></dt>
<dd><p>Building the orbitals list for each fragment. It sets the values of
self.orbitals, self.orb_list and self.orb_list2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.energy_error_bars">
<span class="sig-name descname"><span class="pre">energy_error_bars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_shots</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_resamples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">purify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdm_measurements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.energy_error_bars" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform bootstrapping of measured qubit terms in RDMs to obtain error
bars for the calculated energy. Can also perform McWeeny purification of
the RDMs between resampling and calculating the energy.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>n_shots (int): The number of shots used to resample from qubit</dt><dd><p>terms.</p>
</dd>
<dt>n_resamples (int): The number of bootstrapping samples for the</dt><dd><p>estimate of the energy and standard deviation.</p>
</dd>
<dt>purify (bool): Use mc_weeny_rdm_purification technique on 2-RDMs.</dt><dd><p>Will only apply to fragments with 2 electrons.</p>
</dd>
<dt>rdm_measurements (dict): A dictionary with keys being the DMET</dt><dd><p>fragment number and corresponding values of a dictionary with
keys of qubit terms in the rdm and corresponding values of a
frequencies dictionary of the measurements.
Example: {
0: {((0, “X”), (1, “Y”)): {“10”: 0.5, “01”: 0.5},</p>
<blockquote>
<div><p>((1, “Z”), (1, “X”)): {“00”: 0.25, “11”: 0.25, “01”: 0.5}}</p>
</div></blockquote>
<dl class="simple">
<dt>1: {((0, “Z”)): {“0000”: 1}</dt><dd><p>((0, “X”), (1, “Y”)): {“1111”: 0.5, “0101”: 0.5}}</p>
</dd>
</dl>
<p>}.
If run _oneshot_loop with save_results=True is called:
self.rdm_measurements will have the proper dictionary format
with all values populated.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>float: The bootstrapped DMET energy and standard deviation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.get_resources">
<span class="sig-name descname"><span class="pre">get_resources</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.get_resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the resources required by DMET. Only supports fragments
solved with VQESolver. Resources for each fragments are outputed as a
list.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.DMETProblemDecomposition.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform DMET loop to optimize the chemical potential. It converges
when the electron summation across all fragments is the same as the
number of electron in the molecule.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>float: The DMET energy (dmet_energy).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.Localization">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">qsdk.problem_decomposition.dmet.dmet_problem_decomposition.</span></span><span class="sig-name descname"><span class="pre">Localization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.Localization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Enumeration of the electron localization supported by DMET.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.Localization.iao">
<span class="sig-name descname"><span class="pre">iao</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.Localization.iao" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.dmet_problem_decomposition.Localization.meta_lowdin">
<span class="sig-name descname"><span class="pre">meta_lowdin</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.dmet_problem_decomposition.Localization.meta_lowdin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-qsdk.problem_decomposition.dmet.fragment">
<span id="qsdk-problem-decomposition-dmet-fragment-module"></span><h2>qsdk.problem_decomposition.dmet.fragment module<a class="headerlink" href="#module-qsdk.problem_decomposition.dmet.fragment" title="Permalink to this headline">¶</a></h2>
<p>Module for data structure for DMET fragments.</p>
<dl class="py class">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">qsdk.problem_decomposition.dmet.fragment.</span></span><span class="sig-name descname"><span class="pre">SecondQuantizedDMETFragment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">molecule:</span> <span class="pre">&lt;module</span> <span class="pre">'pyscf.gto'</span> <span class="pre">from</span> <span class="pre">'/home/alex/VirtEnvs/qsdk/lib/python3.8/site-packages/pyscf/gto/__init__.py'&gt;</span></em>, <em class="sig-param"><span class="pre">mean_field:</span> <span class="pre">&lt;module</span> <span class="pre">'pyscf.scf'</span> <span class="pre">from</span> <span class="pre">'/home/alex/VirtEnvs/qsdk/lib/python3.8/site-packages/pyscf/scf/__init__.py'&gt;</span></em>, <em class="sig-param"><span class="pre">n_active_electrons:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">n_active_sos:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">q:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">spin:</span> <span class="pre">int</span></em><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mimicking SecondQuantizedMolecule for DMET fragments. It has the minimal
number of attributes and methods to be parsed by electronic solvers.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.basis">
<span class="sig-name descname"><span class="pre">basis</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.basis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.fermionic_hamiltonian">
<span class="sig-name descname"><span class="pre">fermionic_hamiltonian</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="qsdk.toolboxes.operators.html#qsdk.toolboxes.operators.operators.FermionOperator" title="qsdk.toolboxes.operators.operators.FermionOperator"><span class="pre">qsdk.toolboxes.operators.operators.FermionOperator</span></a></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.fermionic_hamiltonian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.frozen_mos">
<span class="sig-name descname"><span class="pre">frozen_mos</span></span><em class="property"><span class="pre">:</span> <span class="pre">None</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.frozen_mos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.mean_field">
<span class="sig-name descname"><span class="pre">mean_field</span></span><em class="property"><span class="pre">:</span> <span class="pre">&lt;module</span> <span class="pre">'pyscf.scf'</span> <span class="pre">from</span> <span class="pre">'/home/alex/VirtEnvs/qsdk/lib/python3.8/site-packages/pyscf/scf/__init__.py'&gt;</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.mean_field" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.molecule">
<span class="sig-name descname"><span class="pre">molecule</span></span><em class="property"><span class="pre">:</span> <span class="pre">&lt;module</span> <span class="pre">'pyscf.gto'</span> <span class="pre">from</span> <span class="pre">'/home/alex/VirtEnvs/qsdk/lib/python3.8/site-packages/pyscf/gto/__init__.py'&gt;</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.molecule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.n_active_electrons">
<span class="sig-name descname"><span class="pre">n_active_electrons</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.n_active_electrons" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.n_active_mos">
<span class="sig-name descname"><span class="pre">n_active_mos</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.n_active_mos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.n_active_sos">
<span class="sig-name descname"><span class="pre">n_active_sos</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.n_active_sos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.q">
<span class="sig-name descname"><span class="pre">q</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.q" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.spin">
<span class="sig-name descname"><span class="pre">spin</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.spin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.to_pyscf">
<span class="sig-name descname"><span class="pre">to_pyscf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qsdk.problem_decomposition.dmet.fragment.SecondQuantizedDMETFragment.to_pyscf" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to output the PySCF molecule.</p>
<dl class="simple">
<dt>Returns</dt><dd><p>pyscf.gto.Mole: PySCF molecule.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-qsdk.problem_decomposition.dmet">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-qsdk.problem_decomposition.dmet" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">qSDK</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Valentin, Ryan, Alexandre, James.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/qsdk.problem_decomposition.dmet.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>